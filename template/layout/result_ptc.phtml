<div class="container">
	<div class="row">
	<div class="col-12">
		<?php if ($session['result']): $result = $session['result'] ?>
		<h1 class="heading">Результат расчета характеристик компрессора с исходными данными: </h1>
		<table>
			<thead>
			<tr>
                <th>Давление, бар</th>
                <th>Шероховатость, мкм</th>
                <th>Скорость (u<sub>2</sub>)</th>
                <th>Начальная температура, К</th>
                <th>Газовая постоянная, Дж/(кг*К)</th>
                <th>Диаметр (D<sub>2</sub>), мм</th>
                <th>Динамическая вязкость</th>
            </tr>
			</thead>
			<tbody>
			<tr>
                <?php foreach($result['ishod'] as $item): ?>
                    <td><?php echo $item ?></td>
                <?php endforeach; ?>
			</tr>
			</tbody>
		</table>

		<table>
			<thead>
			<tr>
                <th>Число Маха <b>M</b></th>
                <th><b>b<sub>2</sub></b></th>
                <th>Кинематическая вязкость <b>&#957;</b></th>
                <th>Число Рейнольдса <b>Re</b></th>
                <th>Соотношение <b>K<sub>s</sub>/D<sub>h</sub></b></th>
                <th>Коэффициент <b>&#955;<sub>sp</sub></b></th>
                <th>Коэффициент <b>&#955;<sub>&#8734;</sub></b></th>
            </tr>
			</thead>
			<tbody>
			<tr>
                <?php foreach($result['promejutochnie'] as $item): ?>
                    <td><?php echo $item ?></td>
                <?php endforeach; ?>
			</tr>
			</tbody>
		</table>


		<table class="kpd-rashod">
			<caption>Результаты безразмерных характеристик газа в 6-ти точках</caption>
			<thead>
				<th>КПД</th>
				<th>Коеффициент напора</th>
				<th>Коеффициент расхода</th>
			</thead>
			<?php for ($i = 0; $i <= count($result['KPD']) -1; $i++): ?>
				<tr>
					<td><?php echo round($result['KPD'][$i], 3) ?></td>
					<td><?php echo round($result['napor'][$i], 3) ?></td>
					<td><?php echo round($result['rashod'][$i], 3) ?></td>
				</tr>
			<?php endfor; ?>
		</table>
		<div class="result" id="kpd"></div>
		<div class="result" id="psi"></div>
        <div>
            <button type="button" class="button" id="toPdf">Скачать PDF</button>
        </div>
</div>
	</div>
	</div>
    <script>
        (function ($) {
            $(document).ready(function () {
                $('#toPdf').on('click', function () {
                    window.location = '/compr/print/';
                });
                $('#kpd').highcharts({
                    chart: {
                        type: 'spline'
                    },
                    title: {
                        text: 'Сравнительный график зависимостей КПД от коэффициента расхода'
                    },
                    subtitle: {
                        text: 'Для воздуха и газа'
                    },
                    xAxis: {
                        title: {
                            text: '<span style="font-size: 15px; font-weight: bold;">φ</span>'
                        }
                    },
                    yAxis: {
                        title: {
                            text: '<span style="font-size: 15px; font-weight: bold;">η</span>'
                        }
                    },
                    tooltip: {
                        headerFormat: '<b>{series.name}</b><br>',
                        pointFormat: '<span>КПД: <b>{point.y}</b>; Коэф. расхода: <b>{point.x}</b></span>'
                    },
                    plotOptions: {
                        spline: {
                            marker: {
                                enabled: true
                            }
                        },
                        series: {
                            allowPointSelect: true
                        }
                    },

                    series: [{
                        name: 'Воздух',
                        data: [
                            [0.0425, 0.78],
                            [0.0525, 0.82],
                            [0.061, 0.81],
                            [0.0685, 0.76],
                            [0.07, 0.68],
                            [0.0725, 0.5]
                        ]
                    }, {
                        name: 'Газ',
                        data: [
                            [<?php echo $result['rashod'][0] ?>, <?php echo $result['KPD'][0] ?>],
                            [<?php echo $result['rashod'][1] ?>, <?php echo $result['KPD'][1] ?>],
                            [<?php echo $result['rashod'][2] ?>, <?php echo $result['KPD'][2] ?>],
                            [<?php echo $result['rashod'][3] ?>, <?php echo $result['KPD'][3] ?>],
                            [<?php echo $result['rashod'][4] ?>, <?php echo $result['KPD'][4] ?>],
                            [<?php echo $result['rashod'][5] ?>, <?php echo $result['KPD'][5] ?>]
                        ]
                    }]
                });
                $('#psi').highcharts({
                    chart: {
                        type: 'spline'
                    },
                    title: {
                        text: 'Сравнительный график зависимостей коэффициента напора от коэффициента расхода'
                    },
                    subtitle: {
                        text: 'Для воздуха и газа'
                    },
                    xAxis: {
                        title: {
                            text: '<span style="font-size: 15px; font-weight: bold;">φ</span>'
                        }
                    },
                    yAxis: {
                        title: {
                            text: '<span style="font-size: 15px; font-weight: bold;">ψ</span>'
                        }
                    },
                    tooltip: {
                        useHTML: true,
                        shared: true,
                        headerFormat: '<b>{series.name}</b><br>',
                        pointFormat: '<span>Коэф. напора: <b>{point.y}</b>; Коэф. расхода: <b>{point.x}</b></span>'
                    },
                    plotOptions: {
                        spline: {
                            marker: {
                                enabled: true
                            }
                        },
                        series: {
                            allowPointSelect: true
                        }
                    },

                    series: [{
                        name: 'Воздух',
                        data: [
                            [0.0425, 0.59],
                            [0.0525, 0.58],
                            [0.061, 0.55],
                            [0.0685, 0.43],
                            [0.07, 0.4],
                            [0.0725, 0.27]
                        ]
                    }, {
                        name: 'Газ',
                        data: [
                            [<?php echo $result['rashod'][0] ?>, <?php echo $result['napor'][0] ?>],
                            [<?php echo $result['rashod'][1] ?>, <?php echo $result['napor'][1] ?>],
                            [<?php echo $result['rashod'][2] ?>, <?php echo $result['napor'][2] ?>],
                            [<?php echo $result['rashod'][3] ?>, <?php echo $result['napor'][3] ?>],
                            [<?php echo $result['rashod'][4] ?>, <?php echo $result['napor'][4] ?>],
                            [<?php echo $result['rashod'][5] ?>, <?php echo $result['napor'][5] ?>]
                        ]
                    }]
                });
            });
        })(jQuery);
    </script>
    <?php else: ?>
    <h2>Нет результатов. Перейти на страницу для выбора <a href="/">расчета</a></h2>
<?php endif; ?>
